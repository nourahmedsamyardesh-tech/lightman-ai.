<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Light Man AI</title>
    <style>
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù„ÙŠÙƒÙˆÙ† Ù†Ø³Ø®Ø© Ø·Ø¨Ù‚ Ø§Ù„Ø£ØµÙ„ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© */
        body { 
            background-color: #004a99; 
            margin: 0; 
            font-family: Arial, sans-serif; 
            display: flex; 
            flex-direction: column; 
            height: 100vh;
            align-items: center;
        }

        /* Ø§Ù„Ù„ÙˆØ¬Ùˆ Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .header {
            text-align: center;
            padding: 30px 0 10px;
            color: white;
        }
        .header img {
            width: 120px; /* Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø© */
            height: auto;
        }
        .header h1 {
            font-size: 35px;
            margin: 10px 0;
            font-weight: bold;
            color: #ffffff;
        }

        /* Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© */
        .chat-frame {
            background-color: white;
            width: 90%;
            max-width: 400px;
            flex: 1;
            margin-bottom: 20px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 2px solid white;
        }

        #chat-box {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .msg { font-size: 18px; color: black; line-height: 1.4; }
        .bot-msg { align-self: flex-start; text-align: right; font-weight: bold; }
        .user-msg { align-self: flex-start; text-align: right; margin-top: 5px; color: #333; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³ÙÙ„ÙŠØ© */
        .bottom-bar {
            width: 100%;
            border-top: 3px solid #004a99;
            padding: 10px 0;
            display: flex;
            justify-content: center;
            background: white;
        }
        .input-container {
            width: 90%;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .send-btn {
            background-color: #004a99;
            color: white;
            border: none;
            padding: 8px 18px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
        }
        input {
            flex: 1;
            border: 1px solid #ccc;
            border-radius: 20px;
            padding: 8px 15px;
            outline: none;
            text-align: right;
            font-size: 16px;
        }
        .plus-btn {
            background-color: #004a99;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 22px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .clear-chat {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #ffffff33;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<button class="clear-chat" onclick="clearMemory()">Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ğŸ—‘ï¸</button>

<div class="header">
    <img src="https://i.ibb.co/m0fH8Kx/light-man-logo.png" onerror="this.src='https://api.dicebear.com/7.x/identicon/svg?seed=lightman'" alt="Light Man Logo">
    <h1>light man AI</h1>
</div>

<div class="chat-frame">
    <div id="chat-box">
        </div>
    
    <div class="bottom-bar">
        <div class="input-container">
            <button class="send-btn" onclick="talkToAi()">Ø¥Ø±Ø³Ø§Ù„</button>
            <input type="text" id="user-input" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§...">
            <button class="plus-btn">+</button>
        </div>
    </div>
</div>

<script>
    // Ù…ÙØªØ§Ø­ Ø§Ù„Ù€ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
    const MY_API_KEY = "AIzaSyC6iJNfC4jgA44ohT8LyZy2j2zsuC8Qkf8";
    const chatBox = document.getElementById('chat-box');

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡
    window.onload = () => {
        const history = localStorage.getItem('lightman_memory');
        if (history) {
            chatBox.innerHTML = history;
        } else {
            addMessage("Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ Ø§Ù†Ø§ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ùƒ Ø¥Ø³Ù…ÙŠ light man Ai", 'bot');
        }
        chatBox.scrollTop = chatBox.scrollHeight;
    };

    function addMessage(text, type) {
        const msgDiv = document.createElement('div');
        msgDiv.className = type === 'bot' ? 'msg bot-msg' : 'msg user-msg';
        msgDiv.innerText = text;
        chatBox.appendChild(msgDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
        localStorage.setItem('lightman_memory', chatBox.innerHTML);
    }

    async function talkToAi() {
        const input = document.getElementById('user-input');
        const prompt = input.value.trim();
        if (!prompt) return;

        addMessage(prompt, 'user');
        input.value = '';

        try {
            // Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ API Ø§Ù„Ù…Ø­Ø¯Ø« ÙˆØ§Ù„ØµØ­ÙŠØ­ Ù„Ù€ Gemini
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${MY_API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: prompt }] }]
                })
            });

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content.parts[0].text) {
                const aiResponse = data.candidates[0].content.parts[0].text;
                addMessage(aiResponse, 'bot');
            } else {
                throw new Error();
            }

        } catch (error) {
            addMessage("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ù…ÙØªØ§Ø­ Ø§Ù„Ù€ API Ø£Ùˆ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.", "bot");
            console.error(error);
        }
    }

    function clearMemory() {
        localStorage.removeItem('lightman_memory');
        location.reload();
    }

    // Ø¯Ø¹Ù… Ø²Ø± Enter
    document.getElementById('user-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') talkToAi();
    });
</script>

</body>
</html>
